/**************************/
/*** waybetter ************/
/*** by Ron Marcelle ******/
/*** Licensed under MIT ***/
/**************************/
/* debounce function taken pretty */
/* direcly from underscore.js...thanks. */

!function(e){"use strict";var t="waybetter",n=function(e,t){return new i(e,t)},i=function(){var i=this;return i.elements=arguments[0].length?arguments[0]:Array.prototype.slice.call(arguments,0,1),i.elements.forEach(function(e){e[t]={}}),i.settings=c({debounce:0,direction:"vertical",threshold:0,viewport:document.body},arguments[1]||{}),i.callback=a(function(){o.apply(i)},i.settings.debounce),n.elements.length||["scroll","resize"].forEach(function(t){e.addEventListener(t,i.callback)}),i.elements.forEach(function(e){-1===n.elements.indexOf(e)&&n.elements.push(e)}),i.destroy=function(){return i.elements.forEach(function(e){e[t].inview=!1,e.removeAttribute("data-"+t),e.dispatchEvent(r("inview"));var c=n.elements.indexOf(el);c>-1&&n.elements.splice(c,1),i.callbacks.forEach(function(n){e.removeEventListener(t+"."+inout+"view",n)})}),i.elements=[],n.elements.length||["scroll","resize"].forEach(function(t){e.removeEventListener(t,i.callback)}),i},i.inview=function(){return s.apply(this)},i.refresh=function(){return this.dispatchEvent(r("refresh")),o.apply(i)},i.on=function(e,n){return i.callbacks=i.callbacks?i.callbacks:[],i.callbacks.push({inout:e,callback:n}),i.elements.forEach(function(i){i.addEventListener(t+"."+e+"view",n)}),i},o.apply(i)},r=function(e){if("undefined"!=typeof Event)return new Event(t+"."+e);var n=document.createEvent(t+".refreshed");return n.initEvent("custom",!0,!0),n},c=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},a=function(e,t,n){var i;return function(){var r=this,c=arguments,a=function(){i=null,n||e.apply(r,c)},s=n&&!i;clearTimeout(i),i=setTimeout(a,t),s&&e.apply(r,c)}},s=function(e){var t=this.settings.threshold,n=this.settings.viewport,i=e.getBoundingClientRect();return"vertical"===this.settings.direction?i.bottom+t>=0&&i.top+t<=n.clientHeight:i.right+t>=0&&i.left+t<=n.clientWidth},o=function(){var e=this;return n.elements.forEach(function(n){var i=(e.settings,s.call(e,n)),c=n[t],a=c&&c.inview,o=i&&!a,l=!i&&a;(o||l)&&(o?(n[t].inview=!0,n.setAttribute("data-"+t,""),n.dispatchEvent(r("inview"))):l&&(n[t].inview=!1,n.removeAttribute("data-"+t),n.dispatchEvent(r("outview"))))}),e};n.elements=[],n(document.querySelector("[data-"+t+"-watch]"),{direction:"vertical"}),e.waybetter=n}(window);